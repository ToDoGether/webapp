<div class="margin">
  <p id="notice"><%= notice %></p>
  <% if @user_tasks.size > 0 %>
    <div id="search-bar">
      <%= form_tag 'tasks', method: "get", id: "form-subscribe" do %>
        <%= text_field_tag :fulltext, nil, class: "small-padding", placeholder: "Search Tasks ..." %>
        <div>
          <%= submit_tag("", class: "btn search") %>
        </div>
        <div>
          <%= link_to "/filter", class: "btn filter" do end %>
        </div>
      <% end %>
    </div>
  <% else %>
    <div>
      <h4>Welcome! ğŸ‘‹ğŸ¼</h4>
      <p>Thank you for using ToDoGether. For getting started you can either create a new team or subscribe to an already existing team.</p>
      <p>For further information about the application please check out our site on <%= link_to "portfolio.fh-salzburg.ac.at", "https://portfolio.fh-salzburg.ac.at/projects/2021-todogether" %>.</p>
    </div>
  <% end %>
</div>

<% @page_title = "Tasks" %>

<% @user_tasks.each do |user_task|
  task = user_task.task
  status_prev = user_task.status_name(user_task.status_prev)
  status_current = user_task.status_name
  status_next = user_task.status_name(user_task.status_next)
  %>
<div class="task">
  <%= link_to '/change_status/' + user_task.id.to_s + "/prev", class: "btn slide left " + status_prev do end %>
  <section class="task-content">
    <%= link_to task do %>
      <div class="top">
        <div style="color: <%= task.subject.color %>" class="subject"><%= task.subject.name %></div>
        <button class="btn status <%= status_current %>"><%= status_current %></button>
      </div>
      <h4><%= task.name %></h4>
      <div class="bottom">
        <div class="icons">
          <% if(task.weblinks.count > 0) %>
            <%= image_tag("icons/icon-weblink.svg", alt: "Weblink(s) available") %>
          <% end %>
          <% if(task.is_groupwork) %>
            <%= image_tag("icons/icon-group.svg", alt: "Working in a group") %>
          <% end %>
          <% if(task.attachments.count > 0) %>
            <%= image_tag("icons/icon-attachment.svg", alt: "Attachment(s) available") %>
          <% end %>
        </div>
        <div class="duedate"><%= task.formatted_duedate %></div>
      </div>
    <% end %>
  </section>
  <%= link_to '/change_status/' + user_task.id.to_s + "/next", class: "btn slide right " + status_next do end %>
</div>
<% end %>
